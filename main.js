/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){var n=e.baseUrl,r=e.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._headers=r}var n,r;return n=t,(r=[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}},{key:"getInitialUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}},{key:"pathUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"putCardLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}).then(this._checkResponse)}},{key:"deleteCardLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"patchAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkResponse)}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t){var n=t.containerSelector,r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=document.querySelector(n),this._renderer=r}var t,r;return t=e,(r=[{key:"setItem",value:function(e){this._container.prepend(e)}},{key:"_clear",value:function(){this._container.innerHTML=""}},{key:"renderItems",value:function(e){var t=this;this._clear(),e.forEach((function(e){t._renderer(e)}))}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){var n=t.data,r=t.templateSelector,o=t.userId,i=t.handleDeleteBtnClick,a=t.handleLikeBtnClick,c=t.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=n.name,this.link=n.link,this.likes=n.likes,this._ownerId=n.owner._id,this.id=n._id,this._templateSelector=r,this._userId=o,this._handleCardClick=c,this._handleDeleteBtnClick=i,this._handleLikeBtnClick=a}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gallery__list-element").cloneNode(!0)}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._nameElement=this._element.querySelector(".gallery__name"),this._photoElement=this._element.querySelector(".gallery__photo"),this._likeElement=this._element.querySelector(".gallery__like-btn"),this._trashElement=this._element.querySelector(".gallery__trash"),this._countLikesElement=this._element.querySelector(".gallery__like-count"),this._nameElement.textContent=this.name,this._photoElement.src=this.link,this._photoElement.alt=this.name,this.renderLikeContainer(),this._isUserOwner()||this._deleteTrashElement(),this._setEventListeners(),this._element}},{key:"renderLikeContainer",value:function(){this._countLikesElement.textContent=this.likes.length,this.isUserLiked()?this._likeElement.classList.add("gallery__like-btn_active"):this._likeElement.classList.remove("gallery__like-btn_active")}},{key:"isUserLiked",value:function(){var e=this;return this.likes.some((function(t){return t._id===e._userId}))}},{key:"_isUserOwner",value:function(){return this._userId===this._ownerId}},{key:"_deleteTrashElement",value:function(){this._trashElement.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._likeElement.addEventListener("click",(function(){e._handleLikeBtnClick()})),this._trashElement.addEventListener("click",(function(){e._handleDeleteBtnClick()})),this._photoElement.addEventListener("click",(function(){e._handleCardClick()}))}},{key:"deleteCard",value:function(){this._element.remove(),this._element=null}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){var n=t.nameSelector,r=t.aboutSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=document.querySelector(n),this._userAbout=document.querySelector(r),this._userAvatar=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{"user-name":this._userName.textContent,"user-about":this._userAbout.textContent,"user-avatar":this._userAvatar.src}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about,r=e.avatar;this._userName.textContent=t,this._userAbout.textContent=n,this._userAvatar.src=r}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupSelector=t,this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),window.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),window.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&e.close(),t.target.classList.contains("popup__close-btn")&&e.close()}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=h(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function d(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function a(e){var t,n=e.popupSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._popupImg=t._popup.querySelector(".popup__photo"),t._popupNameValue=t._popup.querySelector(".popup__photo-name"),t}return t=a,(n=[{key:"open",value:function(e){var t=e.name,n=e.link;p(v(a.prototype),"open",this).call(this),this._popupImg.src=n,this._popupImg.alt=t,this._popupNameValue.textContent=t}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(l);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function w(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function a(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._handleFormSubmit=r,t._popupForm=t._popup.querySelector(".popup__form"),t._inputsValue={},t._formInputs=t._popup.querySelectorAll(".popup__input"),t._btnSubmit=t._popupForm.querySelector(".popup__save-btn"),t._btnSubmitTextValue=t._btnSubmit.textContent,t}return t=a,(n=[{key:"close",value:function(){g(E(a.prototype),"close",this).call(this),this._popupForm.reset()}},{key:"setInputValue",value:function(e){this._formInputs.forEach((function(t){t.value=e[t.name]}))}},{key:"setLoadnigIsBtn",value:function(e){e?(this._btnSubmit.disabled=!0,this._btnSubmit.textContent="Сохранение..."):(this._btnSubmit.disabled=!1,this._btnSubmit.textContent=this._btnSubmitTextValue)}},{key:"_getInputValues",value:function(){var e=this;return this._formInputs.forEach((function(t){var n=t.getAttribute("name");e._inputsValue[n]=t.value})),this._inputsValue}},{key:"setEventListeners",value:function(){var e=this;g(E(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e._getInputValues())}))}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(l);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=I(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},C.apply(this,arguments)}function I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B(e)););return e}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function x(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(r);if(o){var n=B(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return x(this,e)});function a(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._handleFormSubmit=r,t._popupForm=t._popup.querySelector(".popup__form"),t._btnSubmit=t._popupForm.querySelector(".popup__save-btn"),t._btnSubmitTextValue=t._btnSubmit.textContent,t.cardId=null,t}return t=a,(n=[{key:"close",value:function(){C(B(a.prototype),"close",this).call(this)}},{key:"open",value:function(e){C(B(a.prototype),"open",this).call(this),this.card=e}},{key:"setLoadnigIsBtn",value:function(e){e?(this._btnSubmit.disabled=!0,this._btnSubmit.textContent="Удаление..."):(this._btnSubmit.disabled=!1,this._btnSubmit.textContent=this._btnSubmitTextValue)}},{key:"setEventListeners",value:function(){var e=this;C(B(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e.cardId)}))}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(l);function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t){var n=t.config,r=t.formElement;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formSelector=n.formSelector,this._inputSelector=n.inputSelector,this._submitButtonSelector=n.submitButtonSelector,this._inactiveButtonSelector=n.inactiveButtonSelector,this._inputErrorSelector=n.inputErrorSelector,this._errorSelector=n.errorSelector,this._formElement=r,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){this._errorElement=this._formElement.querySelector("#".concat(e.id,"-error")),e.classList.add(this._inputErrorSelector),this._errorElement.textContent=t,this._errorElement.classList.add(this._errorSelector)}},{key:"_hideInputError",value:function(e){this._errorElement=this._formElement.querySelector("#".concat(e.id,"-error")),e.classList.remove(this._inputErrorSelector),this._errorElement.classList.remove(this._errorSelector),this._errorElement.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonSelector),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonSelector),this._buttonElement.disabled=!1)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),U=document.querySelector(".profile"),V=U.querySelector(".profile__edit-btn"),F=U.querySelector(".profile__picture-btn"),A=U.querySelector(".profile__add-btn"),N={};function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function G(){G=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new L(o||[]);return r(a,"_invoke",{value:k(e,n,c)}),a}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function h(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,_=v&&v(v(O([])));_&&_!==t&&n.call(_,i)&&(d=_);var m=y.prototype=p.prototype=Object.create(d);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function g(e,t){function o(r,i,a,c){var u=s(e[r],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==D(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function k(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=s(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=s(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,f;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function O(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=y,r(m,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,c,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},b(g.prototype),u(g.prototype,a,(function(){return this})),e.AsyncIterator=g,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new g(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=O,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function H(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}var J=null,M=new t({baseUrl:"https://nomoreparties.co/v1/cohort-55",headers:{authorization:"5b60ccac-c30f-46d8-b7b2-7f9c7f002bee","Content-Type":"application/json"}}),Y=new c({nameSelector:".profile__user-name",aboutSelector:".profile__user-about",avatarSelector:".profile__picture"}),z=new _({popupSelector:"#popup_gallery_item"}),K=new R({popupSelector:"#popup_delete_item",handleFormSubmit:function(){K.setLoadnigIsBtn(!0),M.deleteCard(K.card.id).then((function(){K.card.deleteCard(),K.close()})).catch((function(e){console.log(e)})).finally((function(){K.setLoadnigIsBtn(!1)}))}}),Q=new L({popupSelector:"#popup_profile",handleFormSubmit:function(e){Q.setLoadnigIsBtn(!0),M.pathUserInfo({name:e["user-name"],about:e["user-about"]}).then((function(e){Y.setUserInfo(e),Q.close()})).catch((function(e){console.log(e)})).finally((function(){Q.setLoadnigIsBtn(!1)}))}}),W=new L({popupSelector:"#popup_avatar",handleFormSubmit:function(e){W.setLoadnigIsBtn(!0),M.patchAvatar({avatar:e["avatar-link"]}).then((function(e){Y.setUserInfo(e),W.close()})).catch((function(e){console.log(e)})).finally((function(){W.setLoadnigIsBtn(!1)}))}}),X=new L({popupSelector:"#popup_gallery",handleFormSubmit:function(e){X.setLoadnigIsBtn(!0),M.postCard({name:e["photo-name"],link:e["photo-link"]}).then((function(e){Z(e),X.close()})).catch((function(e){console.log(e)})).finally((function(){X.setLoadnigIsBtn(!1)}))}});function Z(e){var t=function(e){var t=new i({data:e,templateSelector:"#gallery-item-template",userId:J,handleDeleteBtnClick:function(){K.open(t)},handleLikeBtnClick:function(){t.isUserLiked()?M.deleteCardLike(t.id).then((function(e){t.likes=e.likes,t.renderLikeContainer()})).catch((function(e){console.log(e)})):M.putCardLike(t.id).then((function(e){t.likes=e.likes,t.renderLikeContainer()})).catch((function(e){console.log(e)}))},handleCardClick:function(){z.open({name:t.name,link:t.link})}});return t.generateCard()}(e);ee.setItem(t)}z.setEventListeners(),Q.setEventListeners(),W.setEventListeners(),X.setEventListeners(),K.setEventListeners();var $,ee=new r({containerSelector:".gallery__list",renderer:function(e){Z(e)}});(function(){var e,t=(e=G().mark((function e(){return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getInitialUserInfo().then((function(e){J=e._id,Y.setUserInfo(e)})).catch((function(e){console.log(e)}));case 2:return e.next=4,M.getInitialCards().then((function(e){ee.renderItems(e.reverse())})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){H(i,r,o,a,c,"next",e)}function c(e){H(i,r,o,a,c,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}})()(),$={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonSelector:"popup__save-btn_disabled",inputErrorSelector:"popup__input_type_error",errorSelector:"popup__input-error_active"},Array.from(document.querySelectorAll($.formSelector)).forEach((function(e){var t=new q({config:$,formElement:e}),n=e.getAttribute("name");N[n]=t,t.enableValidation()})),V.addEventListener("click",(function(){Q.setInputValue(Y.getUserInfo()),N["profile-form"].resetValidation(),Q.open()})),A.addEventListener("click",(function(){N["card-form"].resetValidation(),X.open()})),F.addEventListener("click",(function(){N["avatar-form"].resetValidation(),W.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OEZBQ2Z3SCxFQUNIOEIscUJBQ0EvSyxNQUFLLFNBQUNnTCxHQUNMcEosRUFBU29KLEVBQU83SSxJQUNoQmdILEVBQVNhLFlBQVlnQixFQUN2QixJQUNDeEIsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBQUUsdUJBRUVSLEVBQ0hnQyxrQkFDQWpMLE1BQUssU0FBQ2tMLEdBQ0xOLEdBQWdCTyxZQUFZRCxFQUFNRSxVQUNwQyxJQUNDNUIsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBQUUsMENBL01OLCtLQWdOQyxrQkFuQm1CLG1DQXFCcEI0QixHQUUwQnhFLEVEdE1LLENBQzdCRyxhQUFjLGVBQ2RFLGNBQWUsZ0JBQ2ZFLHFCQUFzQixtQkFDdEJFLHVCQUF3QiwyQkFDeEJFLG1CQUFvQiwwQkFDcEJFLGNBQWUsNkJDaU1FRyxNQUFNQyxLQUFLOUcsU0FBUzhFLGlCQUFpQmUsRUFBT0csZUFDcER4RixTQUFRLFNBQUNzRixHQUNoQixJQUFNd0UsRUFBWSxJQUFJMUUsRUFBYyxDQUNsQ0MsT0FBUUEsRUFDUkMsWUFBYUEsSUFFVHlFLEVBQVd6RSxFQUFZUCxhQUFhLFFBQzFDd0MsRUFBZXdDLEdBQVlELEVBQzNCQSxFQUFVRSxrQkFDWixJQUtGNUMsRUFBbUI1RSxpQkFBaUIsU0FBUyxXQUMzQzZGLEVBQWlCNEIsY0FBY3RDLEVBQVN1QyxlQUN4QzNDLEVBQWUsZ0JBQWdCNEMsa0JBQy9COUIsRUFBaUJVLE1BQ25CLElBRUF6QixFQUF5QjlFLGlCQUFpQixTQUFTLFdBQ2pEK0UsRUFBZSxhQUFhNEMsa0JBQzVCeEIsRUFBZUksTUFDakIsSUFFQTFCLEVBQXFCN0UsaUJBQWlCLFNBQVMsV0FDN0MrRSxFQUFlLGVBQWU0QyxrQkFDOUIxQixFQUFnQk0sTUFDbEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aNChb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBhdGhVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBvc3RDYXJkKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcHV0Q2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBwYXRjaEF2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBjb250YWluZXJTZWxlY3RvciwgcmVuZGVyZXJ9KSB7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIHNldEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgX2NsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgdGhpcy5fY2xlYXIoKTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGRhdGEsXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcbiAgICB1c2VySWQsXG4gICAgaGFuZGxlRGVsZXRlQnRuQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUJ0bkNsaWNrLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgfSkge1xuICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLmxpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ0bkNsaWNrID0gaGFuZGxlRGVsZXRlQnRuQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ0bkNsaWNrID0gaGFuZGxlTGlrZUJ0bkNsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpc3QtZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcblxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX25hbWVcIik7XG4gICAgdGhpcy5fcGhvdG9FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2xpa2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnRuXCIpO1xuICAgIHRoaXMuX3RyYXNoRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X190cmFzaFwiKTtcbiAgICB0aGlzLl9jb3VudExpa2VzRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2xpa2UtY291bnRcIlxuICAgICk7XG5cbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcbiAgICB0aGlzLl9waG90b0VsZW1lbnQuc3JjID0gdGhpcy5saW5rO1xuICAgIHRoaXMuX3Bob3RvRWxlbWVudC5hbHQgPSB0aGlzLm5hbWU7XG5cbiAgICB0aGlzLnJlbmRlckxpa2VDb250YWluZXIoKTtcblxuICAgIGlmICghdGhpcy5faXNVc2VyT3duZXIoKSkge1xuICAgICAgdGhpcy5fZGVsZXRlVHJhc2hFbGVtZW50KCk7XG4gICAgfVxuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxuXG4gIHJlbmRlckxpa2VDb250YWluZXIoKSB7XG4gICAgdGhpcy5fY291bnRMaWtlc0VsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLmxpa2VzLmxlbmd0aDtcblxuICAgIHRoaXMuaXNVc2VyTGlrZWQoKVxuICAgICAgPyB0aGlzLl9saWtlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZ2FsbGVyeV9fbGlrZS1idG5fYWN0aXZlXCIpXG4gICAgICA6IHRoaXMuX2xpa2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJnYWxsZXJ5X19saWtlLWJ0bl9hY3RpdmVcIik7XG4gIH1cblxuICBpc1VzZXJMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5saWtlcy5zb21lKChpdGVtKSA9PiB7XG4gICAgICByZXR1cm4gaXRlbS5faWQgPT09IHRoaXMuX3VzZXJJZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9pc1VzZXJPd25lcigpIHtcbiAgICByZXR1cm4gdGhpcy5fdXNlcklkID09PSB0aGlzLl9vd25lcklkO1xuICB9XG5cbiAgX2RlbGV0ZVRyYXNoRWxlbWVudCgpIHtcbiAgICB0aGlzLl90cmFzaEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdG5DbGljaygpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RyYXNoRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnRuQ2xpY2soKTtcbiAgICB9KTtcbiAgICB0aGlzLl9waG90b0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljaygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICd1c2VyLW5hbWUnOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcbiAgICAgICd1c2VyLWFib3V0JzogdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50LFxuICAgICAgJ3VzZXItYXZhdGFyJzogdGhpcy5fdXNlckF2YXRhci5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwSW1nID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19waG90bycpO1xuICAgIHRoaXMuX3BvcHVwTmFtZVZhbHVlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19waG90by1uYW1lJyk7XG4gIH1cblxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX3BvcHVwSW1nLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcG9wdXBJbWcuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9wb3B1cE5hbWVWYWx1ZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dHNWYWx1ZSA9IHt9O1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcbiAgICB0aGlzLl9idG5TdWJtaXQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZS1idG5cIik7XG4gICAgdGhpcy5fYnRuU3VibWl0VGV4dFZhbHVlID0gdGhpcy5fYnRuU3VibWl0LnRleHRDb250ZW50O1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHNldElucHV0VmFsdWUoZGF0YSkge1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldExvYWRuaWdJc0J0bihpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fYnRuU3VibWl0LnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QtdC90LjQtS4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZTtcbiAgICB9XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICAgIHRoaXMuX2lucHV0c1ZhbHVlW2lucHV0TmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRzVmFsdWU7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGjQoW9uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fYnRuU3VibWl0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmUtYnRuXCIpO1xuICAgIHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZSA9IHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudDtcbiAgICB0aGlzLmNhcmRJZCA9IG51bGw7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgb3BlbihjYXJkKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuY2FyZCA9IGNhcmQ7XG4gIH1cblxuICBzZXRMb2FkbmlnSXNCdG4oaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fYnRuU3VibWl0LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IFwi0KPQtNCw0LvQtdC90LjQtS4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuY2FyZElkKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcih7IGNvbmZpZywgZm9ybUVsZW1lbnQgfSkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uU2VsZWN0b3IgPSBjb25maWcuaW5hY3RpdmVCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dEVycm9yU2VsZWN0b3IgPSBjb25maWcuaW5wdXRFcnJvclNlbGVjdG9yO1xuICAgIHRoaXMuX2Vycm9yU2VsZWN0b3IgPSBjb25maWcuZXJyb3JTZWxlY3RvcjtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JTZWxlY3Rvcik7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yU2VsZWN0b3IpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvclNlbGVjdG9yKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICAgPyB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICA6IHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9O1xufVxuIiwiZXhwb3J0IGNvbnN0IHBvcHVwUGhvdG9JdGVtU2VsZWN0b3IgPSAnI3BvcHVwX2dhbGxlcnlfaXRlbSc7XG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGVJdGVtU2VsZWN0b3IgPSAnI3BvcHVwX2RlbGV0ZV9pdGVtJztcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlU2VsZWN0b3IgPSAnI3BvcHVwX3Byb2ZpbGUnO1xuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdEF2YXRhclNlbGVjdG9yID0gJyNwb3B1cF9hdmF0YXInO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkUGhvdG9TZWxlY3RvciA9ICcjcG9wdXBfZ2FsbGVyeSc7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEluZm9CdG4gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QXZhdGFyQnRuID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGljdHVyZS1idG4nKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XG5cbmV4cG9ydCBjb25zdCBnYWxsZXJ5TGlzdFNlbGVjdG9yID0gJy5nYWxsZXJ5X19saXN0JztcblxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmV4cG9ydCBjb25zdCBjb25maWdWYWxpZGF0b3IgPSB7XG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUtYnRuJyxcbiAgaW5hY3RpdmVCdXR0b25TZWxlY3RvcjogJ3BvcHVwX19zYXZlLWJ0bl9kaXNhYmxlZCcsXG4gIGlucHV0RXJyb3JTZWxlY3RvcjogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JTZWxlY3RvcjogJ3BvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmUnXG59O1xuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aNChb25maXJtYXRpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGjQoW9uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuXG5sZXQgdXNlcklkID0gbnVsbDtcblxuaW1wb3J0IHtcbiAgcG9wdXBQaG90b0l0ZW1TZWxlY3RvcixcbiAgcG9wdXBFZGl0UHJvZmlsZVNlbGVjdG9yLFxuICBwb3B1cEFkZFBob3RvU2VsZWN0b3IsXG4gIHBvcHVwRWRpdEF2YXRhclNlbGVjdG9yLFxuICBwb3B1cERlbGV0ZUl0ZW1TZWxlY3RvcixcbiAgcHJvZmlsZUVkaXRJbmZvQnRuLFxuICBwcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4sXG4gIHByb2ZpbGVFZGl0QXZhdGFyQnRuLFxuICBnYWxsZXJ5TGlzdFNlbGVjdG9yLFxuICBmb3JtVmFsaWRhdG9ycyxcbiAgY29uZmlnVmFsaWRhdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNTVcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNWI2MGNjYWMtYzMwZi00NmQ4LWI3YjItN2Y5YzdmMDAyYmVlXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3VzZXItbmFtZVwiLFxuICBhYm91dFNlbGVjdG9yOiBcIi5wcm9maWxlX191c2VyLWFib3V0XCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19waWN0dXJlXCIsXG59KTtcblxuY29uc3QgcG9wdXBGdWxsU2NyZWVuSW1nID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBQaG90b0l0ZW1TZWxlY3Rvcixcbn0pO1xuXG5jb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBuZXcgUG9wdXBXaXRo0KFvbmZpcm1hdGlvbih7XG4gIHBvcHVwU2VsZWN0b3I6IHBvcHVwRGVsZXRlSXRlbVNlbGVjdG9yLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoKSA9PiB7XG4gICAgcG9wdXBEZWxldGVDYXJkLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQocG9wdXBEZWxldGVDYXJkLmNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5jYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgcG9wdXBEZWxldGVDYXJkLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5zZXRMb2FkbmlnSXNCdG4oZmFsc2UpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcblxuY29uc3QgcG9wdXBGb3JtUHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBFZGl0UHJvZmlsZVNlbGVjdG9yLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXRzVmFsdWUpID0+IHtcbiAgICBwb3B1cEZvcm1Qcm9maWxlLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLnBhdGhVc2VySW5mbyh7XG4gICAgICAgIG5hbWU6IGlucHV0c1ZhbHVlW1widXNlci1uYW1lXCJdLFxuICAgICAgICBhYm91dDogaW5wdXRzVmFsdWVbXCJ1c2VyLWFib3V0XCJdLFxuICAgICAgfSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgICBwb3B1cEZvcm1Qcm9maWxlLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwRm9ybVByb2ZpbGUuc2V0TG9hZG5pZ0lzQnRuKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IHBvcHVwRm9ybUF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBFZGl0QXZhdGFyU2VsZWN0b3IsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZSkgPT4ge1xuICAgIHBvcHVwRm9ybUF2YXRhci5zZXRMb2FkbmlnSXNCdG4odHJ1ZSk7XG4gICAgYXBpXG4gICAgICAucGF0Y2hBdmF0YXIoe1xuICAgICAgICBhdmF0YXI6IGlucHV0c1ZhbHVlW1wiYXZhdGFyLWxpbmtcIl0sXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG4gICAgICAgIHBvcHVwRm9ybUF2YXRhci5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwb3B1cEZvcm1BdmF0YXIuc2V0TG9hZG5pZ0lzQnRuKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IHBvcHVwRm9ybVBob3RvID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBwb3B1cEFkZFBob3RvU2VsZWN0b3IsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZSkgPT4ge1xuICAgIHBvcHVwRm9ybVBob3RvLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLnBvc3RDYXJkKHtcbiAgICAgICAgbmFtZTogaW5wdXRzVmFsdWVbXCJwaG90by1uYW1lXCJdLFxuICAgICAgICBsaW5rOiBpbnB1dHNWYWx1ZVtcInBob3RvLWxpbmtcIl0sXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgcmVuZGVyR2FsbGVyeUl0ZW0oZGF0YSk7XG4gICAgICAgIHBvcHVwRm9ybVBob3RvLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwRm9ybVBob3RvLnNldExvYWRuaWdJc0J0bihmYWxzZSk7XG4gICAgICB9KTtcbiAgfSxcbn0pO1xuXG5wb3B1cEZ1bGxTY3JlZW5JbWcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRm9ybVByb2ZpbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRm9ybUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBGb3JtUGhvdG8uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiBpdGVtLFxuICAgIHRlbXBsYXRlU2VsZWN0b3I6IFwiI2dhbGxlcnktaXRlbS10ZW1wbGF0ZVwiLFxuICAgIHVzZXJJZDogdXNlcklkLFxuICAgIGhhbmRsZURlbGV0ZUJ0bkNsaWNrOiAoKSA9PiB7XG4gICAgICBwb3B1cERlbGV0ZUNhcmQub3BlbihjYXJkKTtcbiAgICB9LFxuICAgIGhhbmRsZUxpa2VCdG5DbGljazogKCkgPT4ge1xuICAgICAgaWYgKGNhcmQuaXNVc2VyTGlrZWQoKSkge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuZGVsZXRlQ2FyZExpa2UoY2FyZC5pZClcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgY2FyZC5saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgICAgICAgICBjYXJkLnJlbmRlckxpa2VDb250YWluZXIoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnB1dENhcmRMaWtlKGNhcmQuaWQpXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNhcmQubGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgICAgICAgICAgY2FyZC5yZW5kZXJMaWtlQ29udGFpbmVyKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgcG9wdXBGdWxsU2NyZWVuSW1nLm9wZW4oe1xuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXG4gICAgICAgIGxpbms6IGNhcmQubGluayxcbiAgICAgIH0pO1xuICAgIH0sXG4gIH0pO1xuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyR2FsbGVyeUl0ZW0oaXRlbSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gIGdhbGxlcnlDYXJkTGlzdC5zZXRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuY29uc3QgZ2FsbGVyeUNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICBjb250YWluZXJTZWxlY3RvcjogZ2FsbGVyeUxpc3RTZWxlY3RvcixcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgcmVuZGVyR2FsbGVyeUl0ZW0oaXRlbSk7XG4gIH0sXG59KTtcblxuY29uc3QgZ2V0SW5pdGlhbERhdGEgPSBhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGFwaVxuICAgIC5nZXRJbml0aWFsVXNlckluZm8oKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHVzZXJJZCA9IHJlc3VsdC5faWQ7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXN1bHQpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSk7XG5cbiAgYXdhaXQgYXBpXG4gICAgLmdldEluaXRpYWxDYXJkcygpXG4gICAgLnRoZW4oKGNhcmRzKSA9PiB7XG4gICAgICBnYWxsZXJ5Q2FyZExpc3QucmVuZGVySXRlbXMoY2FyZHMucmV2ZXJzZSgpKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xufTtcblxuZ2V0SW5pdGlhbERhdGEoKTtcblxuZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihjb25maWcpIHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHtcbiAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgZm9ybUVsZW1lbnQ6IGZvcm1FbGVtZW50LFxuICAgIH0pO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgfSk7XG59XG5cbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnVmFsaWRhdG9yKTtcblxucHJvZmlsZUVkaXRJbmZvQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwRm9ybVByb2ZpbGUuc2V0SW5wdXRWYWx1ZSh1c2VySW5mby5nZXRVc2VySW5mbygpKTtcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRm9ybVByb2ZpbGUub3BlbigpO1xufSk7XG5cbnByb2ZpbGVBZGRHYWxsZXJ5SXRlbUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImNhcmQtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgcG9wdXBGb3JtUGhvdG8ub3BlbigpO1xufSk7XG5cbnByb2ZpbGVFZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRm9ybUF2YXRhci5vcGVuKCk7XG59KTtcbiJdLCJuYW1lcyI6WyJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwiZGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsImFib3V0IiwibGluayIsImNhcmRJZCIsImF2YXRhciIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9yZW5kZXJlciIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaW5uZXJIVE1MIiwiaXRlbXMiLCJfY2xlYXIiLCJmb3JFYWNoIiwiaXRlbSIsIkNhcmQiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlRGVsZXRlQnRuQ2xpY2siLCJoYW5kbGVMaWtlQnRuQ2xpY2siLCJoYW5kbGVDYXJkQ2xpY2siLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJpZCIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX3VzZXJJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQnRuQ2xpY2siLCJfaGFuZGxlTGlrZUJ0bkNsaWNrIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX25hbWVFbGVtZW50IiwiX3Bob3RvRWxlbWVudCIsIl9saWtlRWxlbWVudCIsIl90cmFzaEVsZW1lbnQiLCJfY291bnRMaWtlc0VsZW1lbnQiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsInJlbmRlckxpa2VDb250YWluZXIiLCJfaXNVc2VyT3duZXIiLCJfZGVsZXRlVHJhc2hFbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwibGVuZ3RoIiwiaXNVc2VyTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJzb21lIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiYWJvdXRTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3VzZXJOYW1lIiwiX3VzZXJBYm91dCIsIl91c2VyQXZhdGFyIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltZyIsIl9wb3B1cE5hbWVWYWx1ZSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBGb3JtIiwiX2lucHV0c1ZhbHVlIiwiX2Zvcm1JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J0blN1Ym1pdCIsIl9idG5TdWJtaXRUZXh0VmFsdWUiLCJyZXNldCIsImlucHV0IiwidmFsdWUiLCJpc0xvYWRpbmciLCJkaXNhYmxlZCIsImlucHV0TmFtZSIsImdldEF0dHJpYnV0ZSIsInByZXZlbnREZWZhdWx0IiwiX2dldElucHV0VmFsdWVzIiwiUG9wdXBXaXRo0KFvbmZpcm1hdGlvbiIsImNhcmQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uU2VsZWN0b3IiLCJfaW5wdXRFcnJvclNlbGVjdG9yIiwiaW5wdXRFcnJvclNlbGVjdG9yIiwiX2Vycm9yU2VsZWN0b3IiLCJlcnJvclNlbGVjdG9yIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsIl9idXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiX2Vycm9yRWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicHJvZmlsZSIsInByb2ZpbGVFZGl0SW5mb0J0biIsInByb2ZpbGVFZGl0QXZhdGFyQnRuIiwicHJvZmlsZUFkZEdhbGxlcnlJdGVtQnRuIiwiZm9ybVZhbGlkYXRvcnMiLCJpIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwicG9wdXBGdWxsU2NyZWVuSW1nIiwicG9wdXBEZWxldGVDYXJkIiwic2V0TG9hZG5pZ0lzQnRuIiwiZGVsZXRlQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJwb3B1cEZvcm1Qcm9maWxlIiwiaW5wdXRzVmFsdWUiLCJwYXRoVXNlckluZm8iLCJzZXRVc2VySW5mbyIsInBvcHVwRm9ybUF2YXRhciIsInBhdGNoQXZhdGFyIiwicG9wdXBGb3JtUGhvdG8iLCJwb3N0Q2FyZCIsInJlbmRlckdhbGxlcnlJdGVtIiwiY2FyZEVsZW1lbnQiLCJvcGVuIiwiZGVsZXRlQ2FyZExpa2UiLCJwdXRDYXJkTGlrZSIsImdlbmVyYXRlQ2FyZCIsImNyZWF0ZUNhcmQiLCJnYWxsZXJ5Q2FyZExpc3QiLCJzZXRJdGVtIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJnZXRJbml0aWFsVXNlckluZm8iLCJyZXN1bHQiLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkcyIsInJlbmRlckl0ZW1zIiwicmV2ZXJzZSIsImdldEluaXRpYWxEYXRhIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJlbmFibGVWYWxpZGF0aW9uIiwic2V0SW5wdXRWYWx1ZSIsImdldFVzZXJJbmZvIiwicmVzZXRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==