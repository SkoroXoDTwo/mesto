/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r}var n,r;return n=e,(r=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getInitialUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"pathUserInfo",value:function(t){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.name,about:t.about})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"postCard",value:function(t){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t.name,link:t.link})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"deleteCard",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"putCardLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this._headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"deleteCardLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"patchAvatar",value:function(t){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function t(e){var n=e.containerSelector,r=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._container=document.querySelector(n),this._renderer=r}var e,r;return e=t,(r=[{key:"setItem",value:function(t){this._container.prepend(t)}},{key:"_clear",value:function(){this._container.innerHTML=""}},{key:"renderItems",value:function(t){var e=this;this._clear(),t.forEach((function(t){e._renderer(t)}))}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e){var n=e.data,r=e.templateSelector,o=e.userId,i=e.handleDeleteBtnClick,a=e.handleLikeBtnClick,u=e.handleCardClick;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n.name,this._link=n.link,this._likes=n.likes,this._ownerId=n.owner._id,this.id=n._id,this._templateSelector=r,this._userId=o,this._handleCardClick=u,this._handleDeleteBtnClick=i,this._handleLikeBtnClick=a}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gallery__list-element").cloneNode(!0)}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._nameElement=this._element.querySelector(".gallery__name"),this._photoElement=this._element.querySelector(".gallery__photo"),this._likeElement=this._element.querySelector(".gallery__like-btn"),this._trashElement=this._element.querySelector(".gallery__trash"),this._countLikesElement=this._element.querySelector(".gallery__like-count"),this._nameElement.textContent=this._name,this._photoElement.src=this._link,this._photoElement.alt=this._name,this._renderLikeContainer(),this._isUserOwner()||this._deleteTrashElement(),this._setEventListeners(),this._element}},{key:"_renderLikeContainer",value:function(){this._countLikesElement.textContent=this._likes.length,this._isUserLiked()?this._likeElement.classList.add("gallery__like-btn_active"):this._likeElement.classList.remove("gallery__like-btn_active")}},{key:"_isUserLiked",value:function(){var t=this;return this._likes.some((function(e){return e._id===t._userId}))}},{key:"_isUserOwner",value:function(){return this._userId===this._ownerId}},{key:"_deleteTrashElement",value:function(){this._trashElement.remove()}},{key:"_setEventListeners",value:function(){var t=this;this._likeElement.addEventListener("click",(function(){t._handleLikeBtnClick()})),this._trashElement.addEventListener("click",(function(){t._handleDeleteBtnClick()})),this._photoElement.addEventListener("click",(function(){t._handleCardClick()}))}},{key:"deleteCard",value:function(){this._element.remove(),this._element=null}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(e){var n=e.nameSelector,r=e.aboutSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userName=document.querySelector(n),this._userAbout=document.querySelector(r),this._userAvatar=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{"user-name":this._userName.textContent,"user-about":this._userAbout.textContent,"user-avatar":this._userAvatar.src}}},{key:"setUserInfo",value:function(t){var e=t.name,n=t.about,r=t.avatar;this._userName.textContent=e,this._userAbout.textContent=n,this._userAvatar.src=r}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupSelector=e,this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),window.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),window.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("mousedown",(function(e){e.target.classList.contains("popup_opened")&&t.close(),e.target.classList.contains("popup__close-btn")&&t.close()}))}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=h(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},p.apply(this,arguments)}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function d(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_(r);if(o){var n=_(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return d(this,t)});function a(t){var e,n=t.popupSelector;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,n))._popupImg=e._popup.querySelector(".popup__photo"),e._popupNameValue=e._popup.querySelector(".popup__photo-name"),e}return e=a,(n=[{key:"open",value:function(t){var e=t.name,n=t.link;p(_(a.prototype),"open",this).call(this),this._popupImg.src=n,this._popupImg.alt=e,this._popupNameValue.textContent=e}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(l);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=S(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},g.apply(this,arguments)}function S(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},k(t,e)}function w(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=E(r);if(o){var n=E(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return w(this,t)});function a(t){var e,n=t.popupSelector,r=t.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,n))._handleFormSubmit=r,e._popupForm=e._popup.querySelector(".popup__form"),e._inputsValue={},e._formInputs=e._popup.querySelectorAll(".popup__input"),e._btnSubmit=e._popupForm.querySelector(".popup__save-btn"),e._btnSubmitTextValue=e._btnSubmit.textContent,e}return e=a,(n=[{key:"close",value:function(){g(E(a.prototype),"close",this).call(this),this._popupForm.reset()}},{key:"setInputValue",value:function(t){this._formInputs.forEach((function(e){e.value=t[e.name]}))}},{key:"setLoadnigIsBtn",value:function(t){t?(this._btnSubmit.disabled=!0,this._btnSubmit.textContent="Сохранение..."):(this._btnSubmit.disabled=!1,this._btnSubmit.textContent=this._btnSubmitTextValue)}},{key:"_getInputValues",value:function(){var t=this;return this._formInputs.forEach((function(e){var n=e.getAttribute("name");t._inputsValue[n]=e.value})),this._inputsValue}},{key:"setEventListeners",value:function(){var t=this;g(E(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())}))}}])&&b(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(l);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=P(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},C.apply(this,arguments)}function P(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function x(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=B(r);if(o){var n=B(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return x(this,t)});function a(t){var e,n=t.popupSelector,r=t.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,n))._handleFormSubmit=r,e._popupForm=e._popup.querySelector(".popup__form"),e._btnSubmit=e._popupForm.querySelector(".popup__save-btn"),e._btnSubmitTextValue=e._btnSubmit.textContent,e.cardId=null,e}return e=a,(n=[{key:"close",value:function(){C(B(a.prototype),"close",this).call(this)}},{key:"open",value:function(t){C(B(a.prototype),"open",this).call(this),this.card=t}},{key:"setLoadnigIsBtn",value:function(t){t?(this._btnSubmit.disabled=!0,this._btnSubmit.textContent="Удаление..."):(this._btnSubmit.disabled=!1,this._btnSubmit.textContent=this._btnSubmitTextValue)}},{key:"setEventListeners",value:function(){var t=this;C(B(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t.cardId)}))}}])&&j(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(l);function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var R=function(){function t(e){var n=e.config,r=e.formElement;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._formSelector=n.formSelector,this._inputSelector=n.inputSelector,this._submitButtonSelector=n.submitButtonSelector,this._inactiveButtonSelector=n.inactiveButtonSelector,this._inputErrorSelector=n.inputErrorSelector,this._errorSelector=n.errorSelector,this._formElement=r,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var e,n;return e=t,(n=[{key:"_showInputError",value:function(t,e){this._errorElement=this._formElement.querySelector("#".concat(t.id,"-error")),t.classList.add(this._inputErrorSelector),this._errorElement.textContent=e,this._errorElement.classList.add(this._errorSelector)}},{key:"_hideInputError",value:function(t){this._errorElement=this._formElement.querySelector("#".concat(t.id,"-error")),t.classList.remove(this._inputErrorSelector),this._errorElement.classList.remove(this._errorSelector),this._errorElement.textContent=""}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonSelector),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonSelector),this._buttonElement.disabled=!1)}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"resetValidation",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){t._hideInputError(e)}))}}])&&q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),U=document.querySelector(".profile"),V=U.querySelector(".profile__edit-btn"),F=U.querySelector(".profile__picture-btn"),A=U.querySelector(".profile__add-btn"),N={};function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function G(){G=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new L(o||[]);return r(a,"_invoke",{value:S(t,n,u)}),a}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function p(){}function h(){}function y(){}var d={};c(d,i,(function(){return this}));var _=Object.getPrototypeOf,v=_&&_(_(O([])));v&&v!==e&&n.call(v,i)&&(d=v);var m=y.prototype=p.prototype=Object.create(d);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function g(t,e){function o(r,i,a,u){var c=s(t[r],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==D(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function S(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=k(a,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=s(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=s(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function O(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=y,r(m,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},b(g.prototype),c(g.prototype,a,(function(){return this})),t.AsyncIterator=g,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new g(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=O,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function H(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}var J=null,M=new e({baseUrl:"https://nomoreparties.co/v1/cohort-55",headers:{authorization:"5b60ccac-c30f-46d8-b7b2-7f9c7f002bee","Content-Type":"application/json"}}),Y=new u({nameSelector:".profile__user-name",aboutSelector:".profile__user-about",avatarSelector:".profile__picture"}),z=new v({popupSelector:"#popup_gallery_item"}),K=new T({popupSelector:"#popup_delete_item",handleFormSubmit:function(){K.setLoadnigIsBtn(!0),M.deleteCard(K.card.id).then((function(){K.card.deleteCard()})).catch((function(t){console.log(t)})).finally((function(){K.setLoadnigIsBtn(!1),K.close()}))}}),Q=new L({popupSelector:"#popup_profile",handleFormSubmit:function(t){Q.setLoadnigIsBtn(!0),M.pathUserInfo({name:t["user-name"],about:t["user-about"]}).then((function(t){Y.setUserInfo(t)})).catch((function(t){console.log(t)})).finally((function(){Q.setLoadnigIsBtn(!1),Q.close()}))}}),W=new L({popupSelector:"#popup_avatar",handleFormSubmit:function(t){W.setLoadnigIsBtn(!0),M.patchAvatar({avatar:t["avatar-link"]}).then((function(t){Y.setUserInfo(t)})).catch((function(t){console.log(t)})).finally((function(){W.setLoadnigIsBtn(!1),W.close()}))}}),X=new L({popupSelector:"#popup_gallery",handleFormSubmit:function(t){X.setLoadnigIsBtn(!0),M.postCard({name:t["photo-name"],link:t["photo-link"]}).then((function(t){Z(t)})).catch((function(t){console.log(t)})).finally((function(){X.setLoadnigIsBtn(!1),X.close()}))}});function Z(t){var e=function(t){var e=new i({data:t,templateSelector:"#gallery-item-template",userId:J,handleDeleteBtnClick:function(){K.open(e)},handleLikeBtnClick:function(){e._isUserLiked()?M.deleteCardLike(e.id).then((function(t){e._likes=t.likes,e._renderLikeContainer()})).catch((function(t){console.log(t)})):M.putCardLike(e.id).then((function(t){e._likes=t.likes,e._renderLikeContainer()})).catch((function(t){console.log(t)}))},handleCardClick:function(){z.open({name:e._name,link:e._link})}});return e.generateCard()}(t);tt.setItem(e)}z.setEventListeners(),Q.setEventListeners(),W.setEventListeners(),X.setEventListeners(),K.setEventListeners();var $,tt=new r({containerSelector:".gallery__list",renderer:function(t){Z(t)}});(function(){var t,e=(t=G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.getInitialUserInfo().then((function(t){J=t._id,Y.setUserInfo(t)})).catch((function(t){console.log(t)}));case 2:return t.next=4,M.getInitialCards().then((function(t){tt.renderItems(t.reverse())})).catch((function(t){console.log(t)}));case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){H(i,r,o,a,u,"next",t)}function u(t){H(i,r,o,a,u,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}})()(),$={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonSelector:"popup__save-btn_disabled",inputErrorSelector:"popup__input_type_error",errorSelector:"popup__input-error_active"},Array.from(document.querySelectorAll($.formSelector)).forEach((function(t){var e=new R({config:$,formElement:t}),n=t.getAttribute("name");N[n]=e,e.enableValidation()})),V.addEventListener("click",(function(){Q.setInputValue(Y.getUserInfo()),N["profile-form"].resetValidation(),Q.open()})),A.addEventListener("click",(function(){N["card-form"].resetValidation(),X.open()})),F.addEventListener("click",(function(){N["avatar-form"].resetValidation(),W.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNd0UsRUFBWSxJQUFJMUUsRUFBYyxDQUNsQ0MsT0FBUUEsRUFDUkMsWUFBYUEsSUFFVHlFLEVBQVd6RSxFQUFZUCxhQUFhLFFBQzFDd0MsRUFBZXdDLEdBQVlELEVBQzNCQSxFQUFVRSxrQkFDWixJQUtGNUMsRUFBbUI1RSxpQkFBaUIsU0FBUyxXQUMzQzZGLEVBQWlCNEIsY0FBY3RDLEVBQVN1QyxlQUN4QzNDLEVBQWUsZ0JBQWdCNEMsa0JBQy9COUIsRUFBaUJVLE1BQ25CLElBRUF6QixFQUF5QjlFLGlCQUFpQixTQUFTLFdBQ2pEK0UsRUFBZSxhQUFhNEMsa0JBQzVCeEIsRUFBZUksTUFDakIsSUFFQTFCLEVBQXFCN0UsaUJBQWlCLFNBQVMsV0FDN0MrRSxFQUFlLGVBQWU0QyxrQkFDOUIxQixFQUFnQk0sTUFDbEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aNChb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIHBhdGhVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgcG9zdENhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgcHV0Q2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgcGF0Y2hBdmF0YXIoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBjb250YWluZXJTZWxlY3RvciwgcmVuZGVyZXJ9KSB7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIHNldEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgX2NsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgdGhpcy5fY2xlYXIoKTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGRhdGEsXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcbiAgICB1c2VySWQsXG4gICAgaGFuZGxlRGVsZXRlQnRuQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUJ0bkNsaWNrLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ0bkNsaWNrID0gaGFuZGxlRGVsZXRlQnRuQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ0bkNsaWNrID0gaGFuZGxlTGlrZUJ0bkNsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpc3QtZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcblxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX25hbWVcIik7XG4gICAgdGhpcy5fcGhvdG9FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2xpa2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnRuXCIpO1xuICAgIHRoaXMuX3RyYXNoRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X190cmFzaFwiKTtcbiAgICB0aGlzLl9jb3VudExpa2VzRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2xpa2UtY291bnRcIlxuICAgICk7XG5cbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fcGhvdG9FbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fcGhvdG9FbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLl9yZW5kZXJMaWtlQ29udGFpbmVyKCk7XG5cbiAgICBpZiAoIXRoaXMuX2lzVXNlck93bmVyKCkpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZVRyYXNoRWxlbWVudCgpO1xuICAgIH1cblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfcmVuZGVyTGlrZUNvbnRhaW5lcigpIHtcbiAgICB0aGlzLl9jb3VudExpa2VzRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcblxuICAgIHRoaXMuX2lzVXNlckxpa2VkKClcbiAgICAgID8gdGhpcy5fbGlrZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdhbGxlcnlfX2xpa2UtYnRuX2FjdGl2ZVwiKVxuICAgICAgOiB0aGlzLl9saWtlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZ2FsbGVyeV9fbGlrZS1idG5fYWN0aXZlXCIpO1xuICB9XG5cbiAgX2lzVXNlckxpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChpdGVtKSA9PiB7XG4gICAgICByZXR1cm4gaXRlbS5faWQgPT09IHRoaXMuX3VzZXJJZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9pc1VzZXJPd25lcigpIHtcbiAgICByZXR1cm4gdGhpcy5fdXNlcklkID09PSB0aGlzLl9vd25lcklkO1xuICB9XG5cbiAgX2RlbGV0ZVRyYXNoRWxlbWVudCgpIHtcbiAgICB0aGlzLl90cmFzaEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdG5DbGljaygpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RyYXNoRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnRuQ2xpY2soKTtcbiAgICB9KTtcbiAgICB0aGlzLl9waG90b0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljaygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICd1c2VyLW5hbWUnOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcbiAgICAgICd1c2VyLWFib3V0JzogdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50LFxuICAgICAgJ3VzZXItYXZhdGFyJzogdGhpcy5fdXNlckF2YXRhci5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwSW1nID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19waG90bycpO1xuICAgIHRoaXMuX3BvcHVwTmFtZVZhbHVlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19waG90by1uYW1lJyk7XG4gIH1cblxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX3BvcHVwSW1nLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcG9wdXBJbWcuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9wb3B1cE5hbWVWYWx1ZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dHNWYWx1ZSA9IHt9O1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcbiAgICB0aGlzLl9idG5TdWJtaXQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZS1idG5cIik7XG4gICAgdGhpcy5fYnRuU3VibWl0VGV4dFZhbHVlID0gdGhpcy5fYnRuU3VibWl0LnRleHRDb250ZW50O1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHNldElucHV0VmFsdWUoZGF0YSkge1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldExvYWRuaWdJc0J0bihpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fYnRuU3VibWl0LnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QtdC90LjQtS4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZTtcbiAgICB9XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICAgIHRoaXMuX2lucHV0c1ZhbHVlW2lucHV0TmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRzVmFsdWU7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGjQoW9uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fYnRuU3VibWl0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmUtYnRuXCIpO1xuICAgIHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZSA9IHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudDtcbiAgICB0aGlzLmNhcmRJZCA9IG51bGw7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgb3BlbihjYXJkKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuY2FyZCA9IGNhcmQ7XG4gIH1cblxuICBzZXRMb2FkbmlnSXNCdG4oaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fYnRuU3VibWl0LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IFwi0KPQtNCw0LvQtdC90LjQtS4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idG5TdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2J0blN1Ym1pdC50ZXh0Q29udGVudCA9IHRoaXMuX2J0blN1Ym1pdFRleHRWYWx1ZTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuY2FyZElkKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcih7IGNvbmZpZywgZm9ybUVsZW1lbnQgfSkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uU2VsZWN0b3IgPSBjb25maWcuaW5hY3RpdmVCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dEVycm9yU2VsZWN0b3IgPSBjb25maWcuaW5wdXRFcnJvclNlbGVjdG9yO1xuICAgIHRoaXMuX2Vycm9yU2VsZWN0b3IgPSBjb25maWcuZXJyb3JTZWxlY3RvcjtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JTZWxlY3Rvcik7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yU2VsZWN0b3IpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvclNlbGVjdG9yKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICAgPyB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICA6IHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9O1xufVxuIiwiZXhwb3J0IGNvbnN0IHBvcHVwUGhvdG9JdGVtU2VsZWN0b3IgPSAnI3BvcHVwX2dhbGxlcnlfaXRlbSc7XG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGVJdGVtU2VsZWN0b3IgPSAnI3BvcHVwX2RlbGV0ZV9pdGVtJztcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlU2VsZWN0b3IgPSAnI3BvcHVwX3Byb2ZpbGUnO1xuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdEF2YXRhclNlbGVjdG9yID0gJyNwb3B1cF9hdmF0YXInO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkUGhvdG9TZWxlY3RvciA9ICcjcG9wdXBfZ2FsbGVyeSc7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEluZm9CdG4gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QXZhdGFyQnRuID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGljdHVyZS1idG4nKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XG5cbmV4cG9ydCBjb25zdCBnYWxsZXJ5TGlzdFNlbGVjdG9yID0gJy5nYWxsZXJ5X19saXN0JztcblxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmV4cG9ydCBjb25zdCBjb25maWdWYWxpZGF0b3IgPSB7XG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUtYnRuJyxcbiAgaW5hY3RpdmVCdXR0b25TZWxlY3RvcjogJ3BvcHVwX19zYXZlLWJ0bl9kaXNhYmxlZCcsXG4gIGlucHV0RXJyb3JTZWxlY3RvcjogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JTZWxlY3RvcjogJ3BvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmUnXG59O1xuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aNChb25maXJtYXRpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGjQoW9uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuXG5sZXQgdXNlcklkID0gbnVsbDtcblxuaW1wb3J0IHtcbiAgcG9wdXBQaG90b0l0ZW1TZWxlY3RvcixcbiAgcG9wdXBFZGl0UHJvZmlsZVNlbGVjdG9yLFxuICBwb3B1cEFkZFBob3RvU2VsZWN0b3IsXG4gIHBvcHVwRWRpdEF2YXRhclNlbGVjdG9yLFxuICBwb3B1cERlbGV0ZUl0ZW1TZWxlY3RvcixcbiAgcHJvZmlsZUVkaXRJbmZvQnRuLFxuICBwcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4sXG4gIHByb2ZpbGVFZGl0QXZhdGFyQnRuLFxuICBnYWxsZXJ5TGlzdFNlbGVjdG9yLFxuICBmb3JtVmFsaWRhdG9ycyxcbiAgY29uZmlnVmFsaWRhdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNTVcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNWI2MGNjYWMtYzMwZi00NmQ4LWI3YjItN2Y5YzdmMDAyYmVlXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3VzZXItbmFtZVwiLFxuICBhYm91dFNlbGVjdG9yOiBcIi5wcm9maWxlX191c2VyLWFib3V0XCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19waWN0dXJlXCIsXG59KTtcblxuY29uc3QgcG9wdXBGdWxsU2NyZWVuSW1nID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBQaG90b0l0ZW1TZWxlY3Rvcixcbn0pO1xuXG5jb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBuZXcgUG9wdXBXaXRo0KFvbmZpcm1hdGlvbih7XG4gIHBvcHVwU2VsZWN0b3I6IHBvcHVwRGVsZXRlSXRlbVNlbGVjdG9yLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoKSA9PiB7XG4gICAgcG9wdXBEZWxldGVDYXJkLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQocG9wdXBEZWxldGVDYXJkLmNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5jYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcG9wdXBEZWxldGVDYXJkLnNldExvYWRuaWdJc0J0bihmYWxzZSk7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5jbG9zZSgpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcblxuY29uc3QgcG9wdXBGb3JtUHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBFZGl0UHJvZmlsZVNlbGVjdG9yLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXRzVmFsdWUpID0+IHtcbiAgICBwb3B1cEZvcm1Qcm9maWxlLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLnBhdGhVc2VySW5mbyh7XG4gICAgICAgIG5hbWU6IGlucHV0c1ZhbHVlW1widXNlci1uYW1lXCJdLFxuICAgICAgICBhYm91dDogaW5wdXRzVmFsdWVbXCJ1c2VyLWFib3V0XCJdLFxuICAgICAgfSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwb3B1cEZvcm1Qcm9maWxlLnNldExvYWRuaWdJc0J0bihmYWxzZSk7XG4gICAgICAgIHBvcHVwRm9ybVByb2ZpbGUuY2xvc2UoKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IHBvcHVwRm9ybUF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBFZGl0QXZhdGFyU2VsZWN0b3IsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZSkgPT4ge1xuICAgIHBvcHVwRm9ybUF2YXRhci5zZXRMb2FkbmlnSXNCdG4odHJ1ZSk7XG4gICAgYXBpXG4gICAgICAucGF0Y2hBdmF0YXIoe1xuICAgICAgICBhdmF0YXI6IGlucHV0c1ZhbHVlW1wiYXZhdGFyLWxpbmtcIl0sXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwRm9ybUF2YXRhci5zZXRMb2FkbmlnSXNCdG4oZmFsc2UpO1xuICAgICAgICBwb3B1cEZvcm1BdmF0YXIuY2xvc2UoKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IHBvcHVwRm9ybVBob3RvID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBwb3B1cEFkZFBob3RvU2VsZWN0b3IsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZSkgPT4ge1xuICAgIHBvcHVwRm9ybVBob3RvLnNldExvYWRuaWdJc0J0bih0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLnBvc3RDYXJkKHtcbiAgICAgICAgbmFtZTogaW5wdXRzVmFsdWVbXCJwaG90by1uYW1lXCJdLFxuICAgICAgICBsaW5rOiBpbnB1dHNWYWx1ZVtcInBob3RvLWxpbmtcIl0sXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgcmVuZGVyR2FsbGVyeUl0ZW0oZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwRm9ybVBob3RvLnNldExvYWRuaWdJc0J0bihmYWxzZSk7XG4gICAgICAgIHBvcHVwRm9ybVBob3RvLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgfSxcbn0pO1xuXG5wb3B1cEZ1bGxTY3JlZW5JbWcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRm9ybVByb2ZpbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRm9ybUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBGb3JtUGhvdG8uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiBpdGVtLFxuICAgIHRlbXBsYXRlU2VsZWN0b3I6IFwiI2dhbGxlcnktaXRlbS10ZW1wbGF0ZVwiLFxuICAgIHVzZXJJZDogdXNlcklkLFxuICAgIGhhbmRsZURlbGV0ZUJ0bkNsaWNrOiAoKSA9PiB7XG4gICAgICBwb3B1cERlbGV0ZUNhcmQub3BlbihjYXJkKTtcbiAgICB9LFxuICAgIGhhbmRsZUxpa2VCdG5DbGljazogKCkgPT4ge1xuICAgICAgaWYgKGNhcmQuX2lzVXNlckxpa2VkKCkpIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUNhcmRMaWtlKGNhcmQuaWQpXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNhcmQuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICAgICAgICAgIGNhcmQuX3JlbmRlckxpa2VDb250YWluZXIoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnB1dENhcmRMaWtlKGNhcmQuaWQpXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNhcmQuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICAgICAgICAgIGNhcmQuX3JlbmRlckxpa2VDb250YWluZXIoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XG4gICAgICBwb3B1cEZ1bGxTY3JlZW5JbWcub3Blbih7XG4gICAgICAgIG5hbWU6IGNhcmQuX25hbWUsXG4gICAgICAgIGxpbms6IGNhcmQuX2xpbmssXG4gICAgICB9KTtcbiAgICB9LFxuICB9KTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckdhbGxlcnlJdGVtKGl0ZW0pIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICBnYWxsZXJ5Q2FyZExpc3Quc2V0SXRlbShjYXJkRWxlbWVudCk7XG59XG5cbmNvbnN0IGdhbGxlcnlDYXJkTGlzdCA9IG5ldyBTZWN0aW9uKHtcbiAgY29udGFpbmVyU2VsZWN0b3I6IGdhbGxlcnlMaXN0U2VsZWN0b3IsXG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIHJlbmRlckdhbGxlcnlJdGVtKGl0ZW0pO1xuICB9LFxufSk7XG5cbmNvbnN0IGdldEluaXRpYWxEYXRhID0gYXN5bmMgKCkgPT4ge1xuICBhd2FpdCBhcGlcbiAgICAuZ2V0SW5pdGlhbFVzZXJJbmZvKClcbiAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICB1c2VySWQgPSByZXN1bHQuX2lkO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzdWx0KTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xuXG4gIGF3YWl0IGFwaVxuICAgIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAgIC50aGVuKChjYXJkcykgPT4ge1xuICAgICAgZ2FsbGVyeUNhcmRMaXN0LnJlbmRlckl0ZW1zKGNhcmRzLnJldmVyc2UoKSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcbn07XG5cbmdldEluaXRpYWxEYXRhKCk7XG5cbmZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oY29uZmlnKSB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih7XG4gICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgIGZvcm1FbGVtZW50OiBmb3JtRWxlbWVudCxcbiAgICB9KTtcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZ1ZhbGlkYXRvcik7XG5cbnByb2ZpbGVFZGl0SW5mb0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cEZvcm1Qcm9maWxlLnNldElucHV0VmFsdWUodXNlckluZm8uZ2V0VXNlckluZm8oKSk7XG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwb3B1cEZvcm1Qcm9maWxlLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbXCJjYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRm9ybVBob3RvLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlRWRpdEF2YXRhckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwb3B1cEZvcm1BdmF0YXIub3BlbigpO1xufSk7XG4iXSwibmFtZXMiOlsiQXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJkYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwiYWJvdXQiLCJsaW5rIiwiY2FyZElkIiwiYXZhdGFyIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJpbm5lckhUTUwiLCJpdGVtcyIsIl9jbGVhciIsImZvckVhY2giLCJpdGVtIiwiQ2FyZCIsInRlbXBsYXRlU2VsZWN0b3IiLCJ1c2VySWQiLCJoYW5kbGVEZWxldGVCdG5DbGljayIsImhhbmRsZUxpa2VCdG5DbGljayIsImhhbmRsZUNhcmRDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJpZCIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX3VzZXJJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQnRuQ2xpY2siLCJfaGFuZGxlTGlrZUJ0bkNsaWNrIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX25hbWVFbGVtZW50IiwiX3Bob3RvRWxlbWVudCIsIl9saWtlRWxlbWVudCIsIl90cmFzaEVsZW1lbnQiLCJfY291bnRMaWtlc0VsZW1lbnQiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIl9yZW5kZXJMaWtlQ29udGFpbmVyIiwiX2lzVXNlck93bmVyIiwiX2RlbGV0ZVRyYXNoRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsImxlbmd0aCIsIl9pc1VzZXJMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInNvbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJhYm91dFNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWUiLCJfdXNlckFib3V0IiwiX3VzZXJBdmF0YXIiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJ3aW5kb3ciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1nIiwiX3BvcHVwTmFtZVZhbHVlIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfaW5wdXRzVmFsdWUiLCJfZm9ybUlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnRuU3VibWl0IiwiX2J0blN1Ym1pdFRleHRWYWx1ZSIsInJlc2V0IiwiaW5wdXQiLCJ2YWx1ZSIsImlzTG9hZGluZyIsImRpc2FibGVkIiwiaW5wdXROYW1lIiwiZ2V0QXR0cmlidXRlIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJQb3B1cFdpdGjQoW9uZmlybWF0aW9uIiwiY2FyZCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25TZWxlY3RvciIsIl9pbnB1dEVycm9yU2VsZWN0b3IiLCJpbnB1dEVycm9yU2VsZWN0b3IiLCJfZXJyb3JTZWxlY3RvciIsImVycm9yU2VsZWN0b3IiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiX2J1dHRvbkVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJfZXJyb3JFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJwcm9maWxlIiwicHJvZmlsZUVkaXRJbmZvQnRuIiwicHJvZmlsZUVkaXRBdmF0YXJCdG4iLCJwcm9maWxlQWRkR2FsbGVyeUl0ZW1CdG4iLCJmb3JtVmFsaWRhdG9ycyIsImkiLCJhcGkiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJwb3B1cEZ1bGxTY3JlZW5JbWciLCJwb3B1cERlbGV0ZUNhcmQiLCJzZXRMb2FkbmlnSXNCdG4iLCJkZWxldGVDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsInBvcHVwRm9ybVByb2ZpbGUiLCJpbnB1dHNWYWx1ZSIsInBhdGhVc2VySW5mbyIsInNldFVzZXJJbmZvIiwicG9wdXBGb3JtQXZhdGFyIiwicGF0Y2hBdmF0YXIiLCJwb3B1cEZvcm1QaG90byIsInBvc3RDYXJkIiwicmVuZGVyR2FsbGVyeUl0ZW0iLCJjYXJkRWxlbWVudCIsIm9wZW4iLCJkZWxldGVDYXJkTGlrZSIsInB1dENhcmRMaWtlIiwiZ2VuZXJhdGVDYXJkIiwiY3JlYXRlQ2FyZCIsImdhbGxlcnlDYXJkTGlzdCIsInNldEl0ZW0iLCJzZXRFdmVudExpc3RlbmVycyIsImdldEluaXRpYWxVc2VySW5mbyIsInJlc3VsdCIsImdldEluaXRpYWxDYXJkcyIsImNhcmRzIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiZ2V0SW5pdGlhbERhdGEiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImVuYWJsZVZhbGlkYXRpb24iLCJzZXRJbnB1dFZhbHVlIiwiZ2V0VXNlckluZm8iLCJyZXNldFZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9